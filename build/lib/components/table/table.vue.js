"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),C=require("./useStickyTable.js"),h=require("../checkbox/checkbox.vue.js"),V=require("../icon/icon.vue.js"),E={class:"gov-table-wrap"},N={class:"gov-table-tr"},S={key:0,class:"gov-table-th gov-table-th-selection gov-table-column--fixed-left"},w={key:1,class:"gov-table-th gov-table-th-indexed gov-table-column--fixed-left"},I=["width"],_={key:0,class:"gov-table-arrow"},z=["onClick"],$=["onClick"],F={key:0,class:"gov-table-td gov-table-td-selection gov-table-column--fixed-left"},T={key:1,class:"gov-table-td gov-table-td-indexed gov-table-column--fixed-left"},q=Object.assign({name:"GovTable"},{__name:"table",props:{height:String,rowClassName:Function,loading:Boolean,stripe:Boolean,selection:Boolean,rowKey:[Function,String],indexed:[Function,Boolean],data:{type:Array,default:()=>[]},columns:{type:Array,required:!0}},emits:["sortChange","selectionChange"],setup(o,{emit:y}){const r=o,u=y,d=e.ref([]),b=e.computed(()=>r.height?{height:r.height}:{}),x=(l,a)=>typeof r.indexed=="function"?r.indexed(l,a):a+1,v=e.computed(()=>r.data.map((l,a)=>(typeof r.indexed=="function"?l._rowkey=r.rowKey(l,a):typeof r.indexed=="string"?l._rowkey=l[r.rowKey]:l._rowkey=a,l))),i=e.computed(()=>v.value.map(l=>l._rowkey)),B=e.computed(()=>i.value.some(l=>d.value.includes(l))),m=e.computed(()=>i.value.every(l=>d.value.includes(l))),p=e.computed(()=>B.value&&!m.value),g=e.computed({get(){return m.value},set(l){if(l){const a=new Set([...d.value,...i.value]);d.value=[...a]}else d.value=d.value.filter(a=>!i.value.includes(a))}});e.watch(d,l=>{u("selectionChange",l)});const s=e.ref(null);e.watchEffect(()=>{const l=r.columns.reduceRight((a,t)=>["none","asc","desc"].includes(t.sort)?t:a,null);l&&(s.value={column:l.dataIndex,sort:l.sort})});const k=(l,a)=>{var t,c;l===((t=s.value)==null?void 0:t.column)&&a===((c=s.value)==null?void 0:c.sort)?(s.value=null,u("sortChange",null)):(s.value={column:l,sort:a},u("sortChange",{column:l,sort:a}))},f=e.ref(null);return C.useStickyTable(f),(l,a)=>(e.openBlock(),e.createElementBlock("div",E,[e.createElementVNode("table",{style:e.normalizeStyle(b.value),class:e.normalizeClass(["gov-table",[{"is-striped":o.stripe,"is-fixed":!!o.height}]]),ref_key:"tableEl",ref:f},[e.createElementVNode("thead",null,[e.createElementVNode("tr",N,[o.selection?(e.openBlock(),e.createElementBlock("th",S,[e.createVNode(h.default,{indeterminate:p.value,modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=t=>g.value=t)},null,8,["indeterminate","modelValue"])])):e.createCommentVNode("",!0),o.indexed?(e.openBlock(),e.createElementBlock("th",w,[e.createVNode(V.default,{name:"location"})])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.columns,t=>(e.openBlock(),e.createElementBlock("th",{class:e.normalizeClass(["gov-table-th",[t.align?`align-${t.align}`:"",t.fixed?`gov-table-column--fixed-${t.fixed}`:""]]),key:t.dataIndex,width:t.width,style:e.normalizeStyle(t.width?{minWidth:parseInt(t.width)+"px"}:{})},[e.createTextVNode(e.toDisplayString(t.title)+" ",1),t.sort?(e.openBlock(),e.createElementBlock("span",_,[e.createElementVNode("span",{class:e.normalizeClass(["gov-table-arrow-up",{active:s.value&&s.value.sort==="asc"&&s.value.column===t.dataIndex}]),onClick:c=>k(t.dataIndex,"asc")},null,10,z),e.createElementVNode("span",{class:e.normalizeClass(["gov-table-arrow-down",{active:s.value&&s.value.sort==="desc"&&s.value.column===t.dataIndex}]),onClick:c=>k(t.dataIndex,"desc")},null,10,$)])):e.createCommentVNode("",!0)],14,I))),128))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,(t,c)=>(e.openBlock(),e.createElementBlock("tr",{class:e.normalizeClass(["gov-table-tr",o.rowClassName?o.rowClassName(t,c):""]),key:t._rowkey},[o.selection?(e.openBlock(),e.createElementBlock("td",F,[e.createVNode(h.default,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=n=>d.value=n),value:t._rowkey},null,8,["modelValue","value"])])):e.createCommentVNode("",!0),o.indexed?(e.openBlock(),e.createElementBlock("td",T,e.toDisplayString(x(t,c)),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.columns,n=>(e.openBlock(),e.createElementBlock("td",{key:n.dataIndex,class:e.normalizeClass(["gov-table-td",[n.align?`align-${n.align}`:"",n.fixed?`gov-table-column--fixed-${n.fixed}`:""]])},[e.renderSlot(l.$slots,n.dataIndex,{row:t},()=>[e.createTextVNode(e.toDisplayString(n.format?n.format(t[n.dataIndex],c):t[n.dataIndex]),1)])],2))),128))],2))),128))])],6)]))}});exports.default=q;
